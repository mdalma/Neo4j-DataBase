# Exercici 2

# Exercici 1 (el count retorna un numero de més (337 hauría de ser 336).
MATCH (ind:Individual)-[:VIU]->(p:Habitatge)
WHERE p.municipi = 'CR'
RETURN count(ind.name) as `Número Habitants`, collect(DISTINCT ind.name) as `Llista noms`

# Exercici 2 (OK)
MATCH (h:Habitatge)<-[:VIU]-(p:Individual)
WHERE h.any_padro < 1840 AND h.municipi = 'SFLL'
RETURN DISTINCT h.any_padro as `Any del padró`, collect(distinct(h.id_llar))
ORDER BY h.any_padro

# Exercici 3

# Exercici 4 (DA REPET:()
MATCH path=((i:Individual{name:'miguel', surname:'ballester'})-[:SAME_AS]-(i2:Individual)) RETURN path

# Exercici 5 (OK)
MATCH (ind1:Individual)-[rel]-(ind2:Individual)
WHERE toLower(ind1.name) = 'antonio' AND toLower(ind1.surname) = 'farran'
RETURN ind2.name as `Nom`, ind2.surname as `Cognom1`, ind2.second_surname as `Cognom2`, type(rel) as `Tipus`
ORDER BY ind2.name

#Exercici 6 (OK)
MATCH(p:Individual)-[r:FAMILIA]-> (:Individual) 
RETURN collect(distinct(r.relacio))

#Exercici 7

#Exercici 8


# Exercici 9 (NO ACABADA)
MATCH (ind1:Individual)-[rel:FAMILIA]->(ind2:Individual), (p:Habitatge)
WHERE p.any_padro = 1881 AND p.municipi = 'SFLL' AND rel.relacio = 'fill'
RETURN count(distinct ind1) as `total_fills`, count(distinct p) as `num_llars`

# Exercici 10 (NIDEA)
MATCH (ind:Individual)-[:VIU]->(p:Habitatge)
WHERE p.municipi = 'SFLL' 
UNWIND p.any_padro AS any_padro
WITH DISTINCT any_padro, p.carrer as carrer
RETURN DISTINCT any_padro, carrer
